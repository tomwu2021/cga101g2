<%@ page language="java" contentType="text/html; charset=UTF-8"
pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">  <%-- 在IE執行最新的渲染模式 --%>
<meta name="viewport" content="width=device-width, initial-scale=1">  <%-- 初始化移動瀏覽顯示 --%>
<meta name="Author" content="Dreamer-1.">
<!-- 引入各種CSS樣式表 -->
<link rel="stylesheet" href="css/bootstrap.css">
<link rel="stylesheet" href="css/font-awesome.css">
<link rel="stylesheet" href="css/index.css">  <!-- 修改自Bootstrap官方Demon，你可以按自己的喜好制定CSS樣式 -->
<link rel="stylesheet" href="css/font-change.css">  <!-- 將預設字型從宋體換成微軟雅黑（個人比較喜歡微軟雅黑，移動端和桌面端顯示效果比較接近） -->    
<script type="text/javascript" src="js/jquery-1.12.3.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<title>- 後臺管理系統 -</title>
</head>
<body>
<!-- 頂部選單（來自bootstrap官方Demon）==================================== -->
<nav class="navbar navbar-inverse navbar-fixed-top">
<div class="container">
<div class="navbar-header">
<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" >
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="index.jsp">XXXX.com</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
<ul class="nav navbar-nav navbar-right">            
<li><a href="###" onclick="showAtRight('userList.jsp')"><i class="fa fa-users"></i> 使用者列表</a></li>  
<li><a href="###" onclick="showAtRight('productList.jsp')"><i class="fa fa-list-alt"></i> 產品列表</a></li>
<li><a href="###" onclick="showAtRight('recordList.jsp')" ><i class="fa fa-list"></i> 訂單列表</a></li>  
</ul>
</div>
</div>
</nav>
<!-- 左側選單選項========================================= -->
<div class="container-fluid">
<div class="row-fluie">
<div class="col-sm-3 col-md-2 sidebar">    
<ul class="nav nav-sidebar">
<!-- 一級選單 -->
<li class="active"><a href="#userMeun" class="nav-header menu-first collapsed" data-toggle="collapse">
<i class="fa fa-user"></i>  使用者管理 <span class="sr-only">(current)</span></a>
</li> 
<!-- 二級選單 -->
<!-- 注意一級選單中<a>標籤內的href="#……"裡面的內容要與二級選單中<ul>標籤內的id="……"裡面的內容一致 -->
<ul id="userMeun" class="nav nav-list collapse menu-second">
<li><a href="###" onclick="showAtRight('userList.jsp')"><i class="fa fa-users"></i> 使用者列表</a></li>
</ul>
<li><a href="#productMeun" class="nav-header menu-first collapsed" data-toggle="collapse">
<i class="fa fa-globe"></i>  產品管理 <span class="sr-only">(current)</span></a>
</li> 
<ul id="productMeun" class="nav nav-list collapse menu-second">
<li><a href="###" onclick="showAtRight('productList.jsp')"><i class="fa fa-list-alt"></i> 產品列表</a></li>
</ul>
<li><a href="#recordMeun" class="nav-header menu-first collapsed" data-toggle="collapse">
<i class="fa fa-file-text"></i>  訂單管理 <span class="sr-only">(current)</span></a>
</li> 
<ul id="recordMeun" class="nav nav-list collapse menu-second">
<li><a href="###" onclick="showAtRight('recordList.jsp')" ><i class="fa fa-list"></i> 訂單列表</a></li>
</ul>
</ul>
</div>
</div>
</div>
<!-- 右側內容展示==================================================  -->      
<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
<h1 class="page-header"><i class="fa fa-cog fa-spin"></i> 控制檯<small>   歡迎使用XXX後臺管理系統</small></h1>
<!-- 載入左側選單指向的jsp（或html等）頁面內容 -->
<div id="content">
<h4>          
<strong>使用指南：</strong><br>
<br><br>預設頁面內容……
</h4>                 
</div> 
</div> 
<script type="text/javascript">
/*
* 對選中的標籤啟用active狀態，對先前處於active狀態但之後未被選中的標籤取消active
* （實現左側選單中的標籤點選後變色的效果）
*/
$(document).ready(function () {
$('ul.nav > li').click(function (e) {
//e.preventDefault();  加上這句則導航的<a>標籤會失效
$('ul.nav > li').removeClass('active');
$(this).addClass('active');
});
});
/*
* 解決ajax返回的頁面中含有javascript的辦法：
* 把xmlHttp.responseText中的指令碼都抽取出來，不管AJAX載入的HTML包含多少個指令碼塊，我們對找出來的指令碼塊都呼叫eval方法執行它即可
*/
function executeScript(html)
{
var reg = /<script[^>]*>([^\x00] )$/i;
//對整段HTML片段按<\/script>拆分
var htmlBlock = html.split("<\/script>");
for (var i in htmlBlock) 
{
var blocks;//匹配正規表示式的內容陣列，blocks[1]就是真正的一段指令碼內容，因為前面reg定義我們用了括號進行了捕獲分組
if (blocks = htmlBlock[i].match(reg)) 
{
//清除可能存在的註釋標記，對於註釋結尾-->可以忽略處理，eval一樣能正常工作
var code = blocks[1].replace(/<!--/, '');
try 
{
eval(code) //執行指令碼
} 
catch (e) 
{
}
}
}
}
/*
* 利用div實現左邊點選右邊顯示的效果（以id="content"的div進行內容展示）
* 注意：
*  ①：js獲取網頁的地址，是根據當前網頁來相對獲取的，不會識別根目錄；
*  ②：如果右邊載入的內容顯示頁裡面有css，必須放在主頁（即例中的index.jsp）才起作用
*  （如果單純的兩個頁面之間include，子頁面的css和js在子頁面是可以執行的。 主頁面也可以呼叫子頁面的js。但這時要考慮頁面中js和渲染的先後順序 ）
*/
function showAtRight(url) {
var xmlHttp;
if (window.XMLHttpRequest) {
// code for IE7 , Firefox, Chrome, Opera, Safari
xmlHttp=new XMLHttpRequest();  //建立 XMLHttpRequest物件
}
else {
// code for IE6, IE5
xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
}
xmlHttp.onreadystatechange=function() {    
//onreadystatechange — 當readystate變化時呼叫後面的方法
if (xmlHttp.readyState == 4) {
//xmlHttp.readyState == 4  ——  finished downloading response
if (xmlHttp.status == 200) {
//xmlHttp.status == 200    ——  伺服器反饋正常      
document.getElementById("content").innerHTML=xmlHttp.responseText;  //重設頁面中id="content"的div裡的內容
executeScript(xmlHttp.responseText);  //執行從伺服器返回的頁面內容裡包含的JavaScript函式
}
//錯誤狀態處理
else if (xmlHttp.status == 404){
alert("出錯了☹  （錯誤程式碼：404 Not Found），……！"); 
/* 對404的處理 */
return;
}
else if (xmlHttp.status == 403) { 
alert("出錯了☹  （錯誤程式碼：403 Forbidden），……"); 
/* 對403的處理 */ 
return;
}
else {
alert("出錯了☹  （錯誤程式碼："   request.status   "），……"); 
/* 對出現了其他錯誤程式碼所示錯誤的處理  */
return;
}  
} 
}
//把請求傳送到伺服器上的指定檔案（url指向的檔案）進行處理
xmlHttp.open("GET", url, true);    //true表示非同步處理
xmlHttp.send();
}    
</script>
</body>
</html>